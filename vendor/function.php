<?php

// autoload.php @generated by Composer

require_once __DIR__ . '/composer' . '/autoload_real.php';

return ComposerAutoloaderInit5e29b2c2d84bb23a17bbe59e2ef81d8f::getLoader();
/**
 * @param $url
 * @param $msg
 * @return \Illuminate\Http\RedirectResponse
 * success
 */
function success($msg, $url = '')
{
    if ($url) {
        return redirect($url)->with(['success' => 1, 'msg' => $msg]);
    } else {
        return back()->with(['success' => 1, 'msg' => $msg]);
    }
}

/**
 * @param $msg
 * @return \Illuminate\Http\RedirectResponse
 * error
 */

function error($msg)
{
    return back()->withErrors($msg)->withInput();
}

/**
 * 获取ip地址
 */
function getIP()
{
    $ip = '';
    if (!empty($_SERVER['HTTP_CLIENT_IP'])) {
        return is_ip($_SERVER['HTTP_CLIENT_IP']) ? $_SERVER['HTTP_CLIENT_IP'] : $ip;
    } elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {
        return is_ip($_SERVER['HTTP_X_FORWARDED_FOR']) ? $_SERVER['HTTP_X_FORWARDED_FOR'] : $ip;
    } else {
        return is_ip($_SERVER['REMOTE_ADDR']) ? $_SERVER['REMOTE_ADDR'] : $ip;
    }
}


function is_ip($str)
{
    $ip = explode('.', $str);
    for ($i = 0; $i < count($ip); $i++) {
        if ($ip[$i] > 255) {
            return false;
        }
    }
    return preg_match('/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/', $str);
}

/**
 * 获取地区
 */
function getCity()
{
    /*$ip =getIP();
    $aa = file_get_contents("http://ip.taobao.com/service/getIpInfo.php?ip=$ip");
    $data = json_decode($aa)->data;
    $province = $data->region;
    $city =  $data->city;
    return $province.$city;*/
    return '武汉';
}

/**
 * 操作日志
 */
function plog($title)
{
    if ($title) {
        $admin_id = session('admin_id');
        DB::table('log')->insert([
            'admin_id' => $admin_id,
            'title' => $title
        ]);
    }
}


/**
 * APIStore 获取数据
 * @param $url 接口地址
 * @param null $param 要发送的数据
 * @param bool $ispost 是否采用POST发送,默认GET
 * @return mixed
 */


function APIStore($url, $param = null, $ispost = false)
{
    define('SSL_VERIFYPEER', false);
    $curl = curl_init();
    curl_setopt($curl, CURLOPT_URL, $ispost ? $url : $url . '?' . http_build_query($param));
    //如果是https协议
    if (stripos($url, "https://") !== FALSE) {
        /**
         * 如果需要验证证书
         */
        if (SSL_VERIFYPEER) {
            //验证交换证书
            curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, true);
            //检查SSL证书公用名是否存在，并且是否与提供的主机名匹配
            curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2);
            //设置实现协议为TLS1.0版本
            curl_setopt($curl, CURLOPT_SSLVERSION, CURL_SSLVERSION_TLSv1);
            //根证书文件路径,相对路径和绝对路径均可,
            //推荐使用绝对路径;为了安全证书文件最好不要和应用代码放在一起;
            //用户请保持更新 使用https接口需要设置该证书文件为可信任根证书，
            //以最大限度满足安全性（使用信任任何证书的方式并不安全）。
            curl_setopt($curl, CURLOPT_CAINFO, dirname(__FILE__) . '/cacert.pem');
        } /**
         * 如果不需要验证证书
         */
        else {
            curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE);
            curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE);
            //CURL_SSLVERSION_TLSv1
            curl_setopt($curl, CURLOPT_SSLVERSION, 1);
        }
    }

    //USERAGENT
    curl_setopt($curl, CURLOPT_USERAGENT, 'APIStore');
    //超时时间
    curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 120);
    curl_setopt($curl, CURLOPT_TIMEOUT, 120);
    //通过POST方式提交
    if ($ispost) {
        curl_setopt($curl, CURLOPT_POST, true);
        curl_setopt($curl, CURLOPT_POSTFIELDS, http_build_query($param));
    }
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
    //返回内容
    $callbcak = curl_exec($curl);
    //关闭,释放资源
    curl_close($curl);
    //返回内容JSON_DECODE
    return json_decode($callbcak, true);
}

/**
 * 排序
 */
function treelist($data, $pid, $deep = 1)
{
    static $tree = array();
    foreach ($data as $row) {
        if ($row ['pid'] == $pid) {
            $row ['lever'] = $deep;
            $tree [] = $row;
            treelist($data, $row ['id'], $deep + 1);
        }
    }
    return $tree;
}

/**
 * 上传图片
 *
 */
function uploadImg($img, $auth)
{
    if ($img->isValid()) {                                          //判断上传文件是否有效
        $images = array(                                              //文件格式限制
            'jpg', 'png', 'jpeg', 'gif', 'bmg'
        );
        if (in_array($img->getClientOriginalExtension(), $images)) {         //判断文件后缀是否符合限制
            $size = 2 * 1024 * 1024;                                           //文件大小限制2M
            if ($img->getClientSize() < $size) {
                $name = time() . rand(1000, 9999) . "." . $img->getClientOriginalExtension();      //文件重命名
                $img->move($auth, $name);                 //保存文件，并获取url
                $url = $auth . '/' . $name;
                $data = [
                    'error' => 0,
                    'data' => $url
                ];
                return $data;
            } else {
                $data = [
                    'error' => 1,
                    'data' => '图片超过大小限制'
                ];
                return $data;
            }

        } else {
            $data = [
                'error' => 1,
                'data' => '图片格式不正确'
            ];
            return $data;
        }
    } else {
        $data = [
            'error' => 1,
            'data' => '上传的不是有效的文件'
        ];
        return $data;
    }
}


/**
 * 搜索给默认值
 */

function val($val)
{
    $a = isset($_GET[$val]) ? $_GET[$val] : "";
    $b = isset($_POST[$val]) ? $_POST[$val] : "";
    if ($a) {
        return $a;
    }
    if ($b) {
        return $b;
    }
}

/*
 * 发送验证码
 */
function send($phone, $type)
{
    include_once "send/TopSdk.php";
    //获取手机号
    $c = new TopClient;
    //查询key
    $c->appkey = "23945844";

    $c->secretKey = "d08b7c1586f438bf1f2d21d8ced6a7a0";

    $req = new AlibabaAliqinFcSmsNumSendRequest;

    $req->setExtend("123456");

    $req->setSmsType("normal");

    //获取签名,应用名
    $product = "1234";

    $name = "即付宝";

    $req->setSmsFreeSignName("{$name}");

    //生成验证码
    $code = mt_rand(1, 9) . mt_rand(0, 9) . mt_rand(0, 9) . mt_rand(0, 9);


    $req->setSmsParam("{'code':'{$code}'}");
    $req->setRecNum($phone);

    $SMS = 'SMS_70285230';

    $req->setSmsTemplateCode($SMS);

    $resp = $c->execute($req);

    if ($resp) {  //发送成功
        DB::table('verification')->where(['phone' => $phone, 'type' => $type])->delete();
        $add_arr = array(
            'phone' => $phone,
            'code' => $code,
            'time' => time(),
            'type' => $type
        );
        $add_info = DB::table('verification')->insert($add_arr);
        if ($add_info) {
            return 1;
        } else {
            return 2;
        }
    } else {
        return 2;
    }
}

function SignParamsToString($params)
{
    // 排序
    ksort($params);
    $buff = "";
    foreach ($params as $k => $v) {
        if ($k != "sign" && $v != "" && !is_array($v)) {
            $buff .= $k . "=" . $v . "&";
        }
    }
    $buff = trim($buff, "&");
    return $buff;
}

function postData($url, $postData = '')
{
    $ch = curl_init();
    //设置超时
    curl_setopt($ch, CURLOPT_TIMEOUT, 3600);
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);
    curl_setopt($ch, CURLOPT_HEADER, FALSE);
    if (!empty($postData)) {
        curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData));
        curl_setopt($ch, CURLOPT_POST, 1);
    }
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
    curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_0);

    //运行curl，结果以jason形式返回
    $res = curl_exec($ch);
    curl_close($ch);
    return $res;
}


function merchant_report()
{
    require_once 'baobei/encrypt.php';
    require_once 'baobei/Util.php';
    //结算卡信息(json信息体) 具体信息，请参考文档
    $card = array(
        'cardNoCipher' => '6226097802249251', //银行账号
        'cardName' => 'sdf', //账户名称
        'cardBankNo' => '308584001571', //联行号
    );
    //商户地址信息(json信息体)信息中要求的地区编码，具体信息，请参考文档
    $addressInfo = array(
        'city_code' => '371000',
        'address' => 'tests'
    );
    //
    $contactInfo = array(
        'name' => 'testname', //银行账号
        'phone' => '13561611612', //账户名称

        'cardBankNo' => '308584001571', //联行号
    );
    $arrHashCode = array(
        'requestNo' => '1021490600687652000',//请求流水号
        'version' => 'V1.1',//版本号
        'transId' => '18',//本接口固定传入18
        'agentId' => '100003',
        'payWay' => 'WX',
        'nameAlias' => '浦发银行特约商户1', //商户简称
        'merNo' => '310440300002270',
        'name' => '特约商户3', //商户名称
        'mccValue' => '4816', //所属行业类别
        'legalPerson' => '李四', //法人
        'idcardNo' => '50023619860909031X',//身份证号
        'mobile' => '13561611612',//手机号
        'email' => '18820205538@qq.com', //邮箱
        'cityId' => '44', //城市
        'registerAddress' => '常兴路常兴广场西座13A', //详细地址
        'regNo' => '100000', //社会信用代码
        'regMoney' => '100000', //注册资金
        'regAddress' => 'sdf', //城市
        'spIcp' => 'asdf', //ICP备案登记号
        'remarks' => 'asdf', //备注
        'rateSchema' => '239', //费率id  代理商费率千分之3
        'cardNoCipher' => '6226097802249251', //银行账号
        'cardName' => 'sdf', //账户名称
        'cardBankNo' => '308584001571', //联行号
        'expireTime' => '2021-03-21', //商户失效时间
        'isCompay' => '1', //0:对私 1: 对公账户
        'business' => '203',
        'subMechantName' => 'teste2',
        'subMerchantShortname' => 'test21',
        'contact' => '李四',//联系人
        'contactPhone' => '13561611612',//联系人手机号码
        'contactEmail' => '13561654@qq.com',//联系人邮箱
        'merchantRemark' => 'test',//商户备注信息
        'servicePhone' => '83247941',//联系电话
        'businessLicense' => '1223434',//商户证件编码   企业或者个体工商户提供营业执照，事业单位提供事证号
        'businessLicenseType' => 'NATIONAL_LEGAL',//商户证件类型      取值：NATIONAL_LEGAL营业执照，NATIONAL_LEGAL_MERGE营业执照多证合一，INST_GRST_CTF事业单位法人证书
        'contactInfo' => json_encode($contactInfo), //商户联系信息(json信息体)     json数据，数据透传到支付宝，具体数据参考支付宝官方文档：https://doc.open.alipay.com/docs/doc.htm?docType=1&articleId=106506
        'addressInfo' => json_encode($addressInfo),//商户地址信息(json信息体)信息中要求的地区编码
        'bankCardInfo' => json_encode($card)//结算卡信息(json信息体)
    );

    $dateEncrypt = new encrypt();
    $util = new Util();

    //接口地址区分生产和测试(注:该地址为测试环境地址)
    $url = "http://121.201.32.197:9080/payment-gate-web/gateway/api/backTransReq";
    //验签处理字段
    $arrHashCode['signature'] = urlencode($dateEncrypt->sign($util->SinParamsToString($arrHashCode)));
    $post_data = $util->arrayToString($arrHashCode);

    //数据返回
    return $util->postData($url, $post_data);
}

//微信头像下载
function getImage($url,$save_dir='',$filename='',$type=0){
    if(trim($url)==''){
        return array('file_name'=>'','save_path'=>'','error'=>1);
    }
    if(trim($save_dir)==''){
        $save_dir='./';
    }
    if(trim($filename)==''){//保存文件名
        $ext=strrchr($url,'.');
        if($ext!='.gif'&&$ext!='.jpg'){
            return array('file_name'=>'','save_path'=>'','error'=>3);
        }
        $filename=time().$ext;
    }
    if(0!==strrpos($save_dir,'/')){
        $save_dir.='/';
    }
    //创建保存目录
    if(!file_exists($save_dir)&&!mkdir($save_dir,0777,true)){
        return array('file_name'=>'','save_path'=>'','error'=>5);
    }
    //获取远程文件所采用的方法
    if($type){
        $ch=curl_init();
        $timeout=5;
        curl_setopt($ch,CURLOPT_URL,$url);
        curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
        curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
        $img=curl_exec($ch);
        curl_close($ch);
    }else{
        ob_start();
        readfile($url);
        $img=ob_get_contents();
        ob_end_clean();
    }
    //$size=strlen($img);
    //文件大小
    $fp2=@fopen($save_dir.$filename,'a');
    fwrite($fp2,$img);
    fclose($fp2);
    unset($img,$url);
    return array('file_name'=>$filename,'save_path'=>$save_dir.$filename,'error'=>0);
}

/**
 * 从微信下载图片
 */
function getImageFromWX($headimgurl, $openid)
{
    if ($headimgurl == '/0') {
        $headimgurl = 'http://' . $_SERVER['SERVER_NAME'] . '/images/mr.jpg';
    } else {
        //保存微信头像
        $name = md5($openid);
        $re = getImage($headimgurl, 'users', "$name.jpg", 1);
        if ($re['error'] == 0) {
            $headimgurl = 'http://' . $_SERVER['SERVER_NAME'] . '/' . $re['save_path'];
        } else {
            $headimgurl = 'http://' . $_SERVER['SERVER_NAME'] . '/images/mr.jpg';
        }
    }
    return $headimgurl;
}
/**
 * 获取的钱数处理
 */
function money($money){
    return trim((int)$money);
}

/**
 * 功能:解决unserialize()编码问题
 * @param $str
 * @return mixed|null|string|string[]
 */
function mb_unserialize($str) {
    return preg_replace_callback('#s:(\d+):"(.*?)";#s',function($match){return 's:'.strlen($match[2]).':"'.$match[2].'";';},$str);
}
//------------------------------水浒传-----------------------------
/*
function get_arr(){
    $arr = [];
    for($i=0;$i<3;$i++){
        for($j=0;$j<5;$j++){
            $arr[$i][$j] = rand(1,9);
        }
    }
    return $arr;
}
function get_fen1($arr){
        $rel = check_all($arr);
        $bei = 0;
        if($rel){
            $bei = $rel;
        }else{
            for($i=1;$i<=9;$i++){
                $re = get_road($arr,$i);
                if($re['bei'] > 0){
                    $bei += $re['bei'];
                }
            }

        }
        return $bei;
}

function get_road1($arr,$w=[],$r=[],$a=9,$i=0){
    if($i>4){
        return ['w'=>$w,'r'=>$r,'a'=>$a];
    }else{
        if($a == 9){
            $a = $arr[$i];
            $w[] = $i;
            $r[] = $arr[$i];
            $i++;
            return get_road1($arr,$w,$r,$a,$i);
        }else{
            if($arr[$i]==$a || $arr[$i]==9){
                $w[] = $i;
                $r[] = $arr[$i];
                $i++;
                return get_road1($arr,$w,$r,$a,$i);
            }else{
                return ['w'=>$w,'r'=>$r,'a'=>$a];
            }
        }
    }
}

function get_road2($arr,$w=[],$r=[],$a=9,$i=4){
    if($i<0){
        return ['w'=>$w,'r'=>$r,'a'=>$a];
    }else{
        if($a == 9){
            $a = $arr[$i];
            $w[] = $i;
            $r[] = $arr[$i];
            $i--;
            return get_road2($arr,$w,$r,$a,$i);
        }else{
            if($arr[$i]==$a || $arr[$i]==9){
                $w[] = $i;
                $r[] = $arr[$i];
                $i--;
                return get_road2($arr,$w,$r,$a,$i);
            }else{
                return ['w'=>$w,'r'=>$r,'a'=>$a];
            }
        }
    }
}

function get_road($arr,$road){
    switch ($road) {
        case 1:
            $way = [$arr[1][0],$arr[1][1],$arr[1][2],$arr[1][3],$arr[1][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [1,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [1,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [1,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [1,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 2:
            $way = [$arr[0][0],$arr[0][1],$arr[0][2],$arr[0][3],$arr[0][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [0,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [0,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [0,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [0,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [0,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 3:
            $way = [$arr[2][0],$arr[2][1],$arr[2][2],$arr[2][3],$arr[2][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [2,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [2,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [2,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [2,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [2,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 4:
            $way = [$arr[0][0],$arr[1][1],$arr[2][2],$arr[1][3],$arr[0][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [0,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [1,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [2,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [1,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [0,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 5:
            $way = [$arr[2][0],$arr[1][1],$arr[0][2],$arr[1][3],$arr[2][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [2,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [1,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [0,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [1,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [2,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 6:
            $way = [$arr[0][0],$arr[0][1],$arr[1][2],$arr[0][3],$arr[0][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [0,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [0,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [0,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [0,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 7:
            $way = [$arr[2][0],$arr[2][1],$arr[1][2],$arr[2][3],$arr[2][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [2,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [2,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [2,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [2,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 8:
            $way = [$arr[1][0],$arr[2][1],$arr[2][2],$arr[2][3],$arr[1][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [1,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [2,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [2,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [2,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [1,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        case 9:
            $way = [$arr[1][0],$arr[0][1],$arr[0][2],$arr[0][3],$arr[1][4]];
            $re1 = get_road1($way);
            $re2 = get_road2($way);
            $re = (count($re1['w'])>=count($re2['w'])) ? $re1 : $re2;
            $bei = 0;
            $long = 0;
            $weizhi = [];
            if(count($re['w'])>=3){
                $rel = get_fen($re['a'],$re['r']);
                $bei = $rel['bei'];
                $long = $rel['long'];
                if(in_array(0, $re['w'])){
                    $weizhi[] = [1,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [0,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [0,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [0,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [1,4];
                }
            }
            return ['bei'=>$bei,'long'=>$long,'weizhi'=>$weizhi];
            break;

        default:
            return false;
            break;
    }
}

function get_fen($a,$r){
    $arr[1][3] = 2;
    $arr[1][4] = 4;
    $arr[1][5] = 20;
    $arr[2][3] = 3;
    $arr[2][4] = 10;
    $arr[2][5] = 40;
    $arr[3][3] = 5;
    $arr[3][4] = 15;
    $arr[3][5] = 60;
    $arr[4][3] = 7;
    $arr[4][4] = 20;
    $arr[4][5] = 100;
    $arr[5][3] = 10;
    $arr[5][4] = 30;
    $arr[5][5] = 160;
    $arr[6][3] = 15;
    $arr[6][4] = 40;
    $arr[6][5] = 200;
    $arr[7][3] = 20;
    $arr[7][4] = 80;
    $arr[7][5] = 400;
    $arr[8][3] = 50;
    $arr[8][4] = 200;
    $arr[8][5] = 1000;
    $arr[9][5] = 2000;
    $long = 0;
    $b = count($r);
    $bei = $arr[$a][$b];
    if($b>=4 && $r[0]==9 && $r[1]==9 && $r[2]==9){
        $long++;
        if($r[3] == 9){
            $long++;
            if($b == 5 && $r[4] == 9){
                $long++;
            }
        }
    }
    return ['bei'=>$bei,'long'=>$long];
}

function check_all($arr){
    $arr0 = array_merge($arr[0], $arr[1], $arr[2]);
    $arr1 = array_count_values($arr0);
    $num = count($arr1);
    $bei = 0;
    if($num == 1){
        $a = 0;
        foreach($arr1 as $k=>$v){
            $a = $k;
        }
        if($a == 1){
            $bei = 50;
        }elseif($a == 2){
            $bei = 100;
        }elseif($a == 3){
            $bei = 150;
        }elseif($a == 4){
            $bei = 250;
        }elseif($a == 5){
            $bei = 400;
        }elseif($a == 6){
            $bei = 500;
        }elseif($a == 7){
            $bei = 1000;
        }elseif($a == 8){
            $bei = 2500;
        }elseif($a == 9){
            $bei = 5000;
        }
    }elseif($num <= 3){
        $a = [];
        foreach ($arr1 as $k => $v) {
            $a[] = $k;
        }
        if(!in_array(4,$a) && !in_array(5,$a) && !in_array(6,$a) && !in_array(7,$a) && !in_array(8,$a) && !in_array(9,$a)){
            $bei = 15;
        }elseif(!in_array(1,$a)&&!in_array(2,$a)&&!in_array(3,$a)&&!in_array(7,$a)&&!in_array(8,$a)&&!in_array(9,$a)){
            $bei = 50;
        }
    }

    return $bei;
}
*/
//------------------------------水浒传-----------------------------
/*
function get_arr(){
    $arr = [];
    for($i=0;$i<3;$i++){
        for($j=0;$j<5;$j++){
            $arr[$i][$j] = rand(1,9);
        }
    }
    return $arr;
}
function get_fen1($arr){
    $bei = 0;
        for($i=1;$i<=9;$i++){
                $re = xget_road($arr,$i);
                if($re['bei'] > 0){

                    $bei += $re['bei'];

                }
            }
        return $bei;
}
function xget_road1($arr,$w=[],$r=[],$a=9,$i=0){
    if($i>4){
        return ['w'=>$w,'r'=>$r,'a'=>$a];
    }else{
        if($a == 9){
            if($arr[$i] < 10){
                $a = $arr[$i];
                $w[] = $i;
                $r[] = $arr[$i];
                $i++;
                return xget_road1($arr,$w,$r,$a,$i);
            }else{
                return ['w'=>$w,'r'=>$r,'a'=>$a];
            }
        }else{
            if($arr[$i]==$a || $arr[$i]==9){
                $w[] = $i;
                $r[] = $arr[$i];
                $i++;
                return xget_road1($arr,$w,$r,$a,$i);
            }else{
                return ['w'=>$w,'r'=>$r,'a'=>$a];
            }
        }
    }
}

function xget_road2($arr,$w=[],$r=[],$a=9,$i=4){
    if($i<0){
        return ['w'=>$w,'r'=>$r,'a'=>$a];
    }else{
        if($a == 9){
            if($arr[$i] < 10){
                $a = $arr[$i];
                $w[] = $i;
                $r[] = $arr[$i];
                $i--;
                return xget_road2($arr,$w,$r,$a,$i);
            }else{
                return ['w'=>$w,'r'=>$r,'a'=>$a];
            }
        }else{
            if($arr[$i]==$a || $arr[$i]==9){
                $w[] = $i;
                $r[] = $arr[$i];
                $i--;
                return xget_road2($arr,$w,$r,$a,$i);
            }else{
                return ['w'=>$w,'r'=>$r,'a'=>$a];
            }
        }
    }
}

function xget_road($arr,$road){
    switch ($road) {
        case 1:
            $way = [$arr[0][0],$arr[0][1],$arr[0][2],$arr[0][3],$arr[0][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){

                if(in_array(0, $re['w'])){
                    $weizhi[] = [0,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [0,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [0,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [0,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [0,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 2:
            $way = [$arr[1][0],$arr[1][1],$arr[1][2],$arr[1][3],$arr[1][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [1,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [1,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [1,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [1,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 3:
            $way = [$arr[2][0],$arr[2][1],$arr[2][2],$arr[2][3],$arr[2][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [2,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [2,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [2,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [2,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [2,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 4:
            $way = [$arr[0][0],$arr[1][1],$arr[2][2],$arr[1][3],$arr[0][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [0,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [1,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [2,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [1,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [0,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 5:
            $way = [$arr[2][0],$arr[1][1],$arr[0][2],$arr[1][3],$arr[2][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [2,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [1,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [0,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [1,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [2,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 6:
            $way = [$arr[0][0],$arr[0][1],$arr[1][2],$arr[2][3],$arr[2][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [0,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [0,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [2,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [2,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 7:
            $way = [$arr[2][0],$arr[2][1],$arr[1][2],$arr[0][3],$arr[0][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [2,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [2,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [0,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [0,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 8:
            $way = [$arr[1][0],$arr[0][1],$arr[1][2],$arr[2][3],$arr[1][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [1,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [0,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [2,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [1,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        case 9:
            $way = [$arr[1][0],$arr[2][1],$arr[1][2],$arr[0][3],$arr[1][4]];
            $re1 = xget_road1($way);
            $re2 = xget_road2($way);
            $fen1 = xget_fen($re1['a'],$re1['r']);
            $fen2 = xget_fen($re2['a'],$re2['r']);
            $re = ($fen1 > $fen2) ? $re1 : $re2;
            $bei = ($fen1 > $fen2) ? $fen1 : $fen2;
            $weizhi = [];
            if($bei>0){
                if(in_array(0, $re['w'])){
                    $weizhi[] = [1,0];
                }
                if(in_array(1, $re['w'])){
                    $weizhi[] = [2,1];
                }
                if(in_array(2, $re['w'])){
                    $weizhi[] = [1,2];
                }
                if(in_array(3, $re['w'])){
                    $weizhi[] = [0,3];
                }
                if(in_array(4, $re['w'])){
                    $weizhi[] = [1,4];
                }
            }
            return ['bei'=>$bei,'weizhi'=>$weizhi];
            break;

        default:
            return false;
            break;
    }
}

function xget_fen($a,$r){
    $arr[1][2] = 1;
    $arr[1][3] = 3;
    $arr[1][4] = 10;
    $arr[1][5] = 50;
    $arr[2][2] = 2;
    $arr[2][3] = 5;
    $arr[2][4] = 15;
    $arr[2][5] = 70;
    $arr[3][2] = 3;
    $arr[3][3] = 10;
    $arr[3][4] = 30;
    $arr[3][5] = 100;
    $arr[4][3] = 30;
    $arr[4][4] = 70;
    $arr[4][5] = 500;
    $arr[5][3] = 35;
    $arr[5][4] = 80;
    $arr[5][5] = 650;
    $arr[6][3] = 45;
    $arr[6][4] = 100;
    $arr[6][5] = 800;
    $arr[7][3] = 75;
    $arr[7][4] = 175;
    $arr[7][5] = 1200;
    $arr[8][3] = 80;
    $arr[8][4] = 200;
    $arr[8][5] = 2000;
    $b = count($r);
    $bei = isset($arr[$a][$b]) ? $arr[$a][$b] : 0;
    return $bei;
}
*/